! test arrays set in units used in ALI-ARMS non-LTE code - skip to call wrapper()
       real H(70) /1.4416e+002,
     &     1.3361e+002,1.2463e+002,1.1725e+002,1.1112e+002,1.0601e+002,
     &     1.0176e+002,9.8077e+001,9.4831e+001,9.1971e+001,8.9313e+001,
     &     8.6794e+001,8.4469e+001,8.2313e+001,8.0215e+001,7.8028e+001,
     &     7.5694e+001,7.3159e+001,7.0357e+001,6.7351e+001,6.4284e+001,
     &     6.1295e+001,5.8494e+001,5.5952e+001,5.3650e+001,5.1478e+001,
     &     4.9344e+001,4.7236e+001,4.5164e+001,4.3142e+001,4.1177e+001,
     &     3.9275e+001,3.7445e+001,3.5694e+001,3.4022e+001,3.2422e+001,
     &     3.0885e+001,2.9405e+001,2.7980e+001,2.6604e+001,2.5273e+001,
     &     2.3984e+001,2.2734e+001,2.1522e+001,2.0347e+001,1.9203e+001,
     &     1.8014e+001,1.6862e+001,1.5789e+001,1.4709e+001,1.3625e+001,
     &     1.2540e+001,1.1467e+001,1.0413e+001,9.3678e+000,8.3123e+000,
     &     7.2343e+000,6.1284e+000,4.9830e+000,3.8807e+000,2.9300e+000,
     &     2.1631e+000,1.5920e+000,1.2255e+000,9.7341e-001,7.4433e-001,
     &     5.3846e-001,3.5585e-001,1.9683e-001,6.1563e-002/
       real P(70) /5.9603e-009,
     &     9.8269e-009,1.6202e-008,2.6712e-008,4.4041e-008,7.2613e-008,
     &     1.1972e-007,1.9738e-007,3.2542e-007,5.3653e-007,8.8460e-007,
     &     1.4585e-006,2.4046e-006,3.9782e-006,6.5568e-006,1.0814e-005,
     &     1.7898e-005,2.9558e-005,4.8731e-005,7.9911e-005,1.2827e-004,
     &     1.9812e-004,2.9203e-004,4.1017e-004,5.5347e-004,7.3048e-004,
     &     9.5595e-004,1.2448e-003,1.6128e-003,2.0793e-003,2.6674e-003,
     &     3.4049e-003,4.3246e-003,5.4654e-003,6.8728e-003,8.5997e-003,
     &     1.0707e-002,1.3265e-002,1.6352e-002,2.0057e-002,2.4479e-002,
     &     2.9728e-002,3.5923e-002,4.3194e-002,5.1677e-002,6.1520e-002,
     &     7.3751e-002,8.7821e-002,1.0332e-001,1.2155e-001,1.4299e-001,
     &     1.6823e-001,1.9770e-001,2.3218e-001,2.7273e-001,3.2044e-001,
     &     3.7657e-001,4.4261e-001,5.2029e-001,6.0429e-001,6.8486e-001,
     &     7.5595e-001,8.1267e-001,8.5085e-001,8.7798e-001,9.0327e-001,
     &     9.2653e-001,9.4754e-001,9.6614e-001,9.8218e-001/
       real T(70) /7.6965e+002,
     &     6.8051e+002,5.5612e+002,4.6068e+002,3.8393e+002,3.1934e+002,
     &     2.6598e+002,2.3916e+002,2.0713e+002,1.8545e+002,1.7832e+002,
     &     1.6690e+002,1.5197e+002,1.4173e+002,1.4468e+002,1.5344e+002,
     &     1.6231e+002,1.8136e+002,2.0002e+002,2.1394e+002,2.2710e+002,
     &     2.4068e+002,2.5054e+002,2.5876e+002,2.6468e+002,2.6953e+002,
     &     2.7215e+002,2.7326e+002,2.7287e+002,2.7092e+002,2.6804e+002,
     &     2.6412e+002,2.5869e+002,2.5233e+002,2.4630e+002,2.4130e+002,
     &     2.3773e+002,2.3418e+002,2.3116e+002,2.2911e+002,2.2720e+002,
     &     2.2593e+002,2.2508e+002,2.2379e+002,2.2398e+002,2.2407e+002,
     &     2.2445e+002,2.2525e+002,2.2624e+002,2.2773e+002,2.2816e+002,
     &     2.2766e+002,2.2637e+002,2.2200e+002,2.2161e+002,2.2563e+002,
     &     2.3054e+002,2.3694e+002,2.4659e+002,2.5575e+002,2.6206e+002,
     &     2.6699e+002,2.7067e+002,2.7284e+002,2.7422e+002,2.7514e+002,
     &     2.7654e+002,2.7791e+002,2.7914e+002,2.8016e+002/
       real CO2(70) /1.5379e-005,
     &     2.1472e-005,3.3118e-005,4.7102e-005,6.4069e-005,7.9057e-005,
     &     1.0416e-004,1.2250e-004,1.7361e-004,2.4031e-004,2.8699e-004,
     &     3.3595e-004,3.5584e-004,3.6713e-004,3.6878e-004,3.6949e-004,
     &     3.6987e-004,3.7004e-004,3.7016e-004,3.7031e-004,3.7036e-004,
     &     3.7039e-004,3.7040e-004,3.7040e-004,3.7019e-004,3.7014e-004,
     &     3.7017e-004,3.7019e-004,3.7019e-004,3.7016e-004,3.7012e-004,
     &     3.7005e-004,3.6996e-004,3.6992e-004,3.6985e-004,3.6979e-004,
     &     3.6972e-004,3.6980e-004,3.6986e-004,3.6981e-004,3.6981e-004,
     &     3.6984e-004,3.6982e-004,3.6988e-004,3.7038e-004,3.7078e-004,
     &     3.7107e-004,3.7114e-004,3.7118e-004,3.7116e-004,3.7101e-004,
     &     3.7103e-004,3.7106e-004,3.7126e-004,3.7167e-004,3.7175e-004,
     &     3.7174e-004,3.7135e-004,3.6971e-004,3.6839e-004,3.6793e-004,
     &     3.6748e-004,3.6749e-004,3.6735e-004,3.6727e-004,3.6724e-004,
     &     3.6723e-004,3.6719e-004,3.6710e-004,3.6681e-004/
       real N2(70) /7.1108e-001,
     &     7.2492e-001,7.4131e-001,7.5649e-001,7.6845e-001,7.7522e-001,
     &     7.7940e-001,7.8429e-001,7.8988e-001,7.9239e-001,7.9242e-001,
     &     7.8992e-001,7.8848e-001,7.8746e-001,7.8729e-001,7.8723e-001,
     &     7.8721e-001,7.8720e-001,7.8720e-001,7.8720e-001,7.8720e-001,
     &     7.8721e-001,7.8721e-001,7.8722e-001,7.8725e-001,7.8725e-001,
     &     7.8725e-001,7.8725e-001,7.8725e-001,7.8725e-001,7.8725e-001,
     &     7.8726e-001,7.8726e-001,7.8726e-001,7.8726e-001,7.8726e-001,
     &     7.8727e-001,7.8727e-001,7.8727e-001,7.8728e-001,7.8728e-001,
     &     7.8728e-001,7.8728e-001,7.8729e-001,7.8728e-001,7.8728e-001,
     &     7.8729e-001,7.8730e-001,7.8735e-001,7.8735e-001,7.8735e-001,
     &     7.8736e-001,7.8737e-001,7.8737e-001,7.8736e-001,7.8735e-001,
     &     7.8737e-001,7.8742e-001,7.8752e-001,7.8745e-001,7.8741e-001,
     &     7.8741e-001,7.8745e-001,7.8746e-001,7.8745e-001,7.8745e-001,
     &     7.8740e-001,7.8737e-001,7.8734e-001,7.8732e-001/
       real O2(70) /5.4525e-002,
     &     5.8536e-002,6.7428e-002,7.8989e-002,9.2468e-002,1.0535e-001,
     &     1.2101e-001,1.3035e-001,1.5192e-001,1.7683e-001,1.9216e-001,
     &     2.0507e-001,2.0975e-001,2.1197e-001,2.1231e-001,2.1240e-001,
     &     2.1242e-001,2.1243e-001,2.1243e-001,2.1243e-001,2.1243e-001,
     &     2.1242e-001,2.1242e-001,2.1241e-001,2.1238e-001,2.1237e-001,
     &     2.1237e-001,2.1237e-001,2.1237e-001,2.1237e-001,2.1237e-001,
     &     2.1237e-001,2.1237e-001,2.1237e-001,2.1237e-001,2.1236e-001,
     &     2.1235e-001,2.1236e-001,2.1236e-001,2.1235e-001,2.1235e-001,
     &     2.1234e-001,2.1234e-001,2.1234e-001,2.1235e-001,2.1234e-001,
     &     2.1234e-001,2.1232e-001,2.1228e-001,2.1228e-001,2.1228e-001,
     &     2.1227e-001,2.1226e-001,2.1226e-001,2.1227e-001,2.1227e-001,
     &     2.1225e-001,2.1221e-001,2.1211e-001,2.1219e-001,2.1222e-001,
     &     2.1222e-001,2.1218e-001,2.1217e-001,2.1218e-001,2.1219e-001,
     &     2.1223e-001,2.1227e-001,2.1229e-001,2.1231e-001/
       real O(70) /2.3438e-001,
     &     2.1652e-001,1.9122e-001,1.6448e-001,1.3901e-001,1.1935e-001,
     &     9.9477e-002,8.5243e-002,5.8027e-002,3.0535e-002,1.5129e-002,
     &     4.6743e-003,1.4184e-003,2.0009e-004,3.1234e-005,4.1880e-006,
     &     2.5519e-006,1.8126e-006,1.4000e-006,1.1117e-006,8.8607e-007,
     &     7.0344e-007,5.5031e-007,4.1972e-007,3.0805e-007,2.1909e-007,
     &     1.4891e-007,9.7125e-008,6.0421e-008,3.5112e-008,1.9050e-008,
     &     9.7007e-009,4.8125e-009,2.3706e-009,1.1983e-009,6.1620e-010,
     &     3.3420e-010,1.7631e-010,9.7724e-011,5.9060e-011,3.3289e-011,
     &     2.0756e-011,1.1914e-011,6.2257e-012,3.6902e-012,2.0734e-012,
     &     1.0699e-012,5.2245e-013,2.8206e-013,1.7754e-013,1.1501e-013,
     &     6.7476e-014,4.5384e-014,2.3849e-014,1.0271e-014,4.3517e-015,
     &     2.3899e-015,1.2587e-015,5.3470e-016,2.2874e-016,1.6188e-016,
     &     1.1595e-016,8.4261e-017,6.2877e-017,4.9497e-017,2.8788e-017,
     &     2.6991e-017,2.5817e-017,2.4757e-017,2.3473e-017/
       real	CH_rate(70)

       ! don't use this module in the real code before calling the wrapper !!!! It just converts the arrays above to WACCM units
       do i=1,70
         CH_rate(i)     =0.0
         H(i)=H(i)*1000.0 ! original WACCM is in meters
         P(i)=P(i)*1e5 ! original pressure is in Pa
         print 222,i,H(i),P(i),T(i),CO2(i),O(i),N2(i),O2(i)
       end do
       ! ========= end of the modules 

       call wrapper(H,P,T,CO2,O,N2,O2,CH_rate,70) ! this is the Fortran interface to ALI-ARMS non-LTE code
       
       do i=1,70
         print 111,i,H(i)/1000.0,CH_rate(i)*24*60*60 ! to get it n K/day
       end do

111    format('FORTRAN: id= ',I3,' H= ',f6.1,' CH=',E15.7)
222    format('id=',I3,' H=',f9.1, 'P=',E10.3, 'T=',f6.1, ' CO2=',E10.3,
     & ' O= ',E9.3,' N2= ',E9.3,' O2=',E9.3)

       stop
       end
